<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tnelso95 | Portfolio</title>
  <style>
    html, body { height: 100%; margin: 0; }
    body {
      display: flex;
      flex-direction: column;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
      background: #0f172a;
      color: #e2e8f0;
    }
    header {
      background: rgba(2, 6, 23, 0.9);
      border-bottom: 1px solid rgba(148, 163, 184, 0.15);
      box-shadow: 0 4px 20px rgba(0,0,0,0.35);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .header-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px 24px;
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 16px;
      align-items: center;
    }
    .branding {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .site-title {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.3px;
    }
    .site-tagline {
      margin: 0;
      font-size: 14px;
      color: #94a3b8;
    }
    nav {
      display: flex;
      gap: 12px;
    }
    .nav-link {
      padding: 8px 12px;
      border-radius: 8px;
      color: #e2e8f0;
      text-decoration: none;
      font-size: 14px;
      border: 1px solid rgba(148, 163, 184, 0.18);
      background: rgba(255,255,255,0.03);
      transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
      cursor: pointer;
    }
    .nav-link:hover, .nav-link.active {
      background: rgba(255,255,255,0.08);
      border-color: rgba(148, 163, 184, 0.35);
      color: #ffffff;
    }
    main {
      flex: 1;
      padding: 32px 24px 48px;
    }
    
    /* Page Management */
    .page {
      display: none;
      animation: fadeIn 0.3s ease-in-out;
    }
    .page.active {
      display: block;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Home Page Styles */
    .hero {
      max-width: 1100px;
      margin: 24px auto 0;
    }
    .hero-inner {
      display: grid;
      grid-template-columns: 1fr 1.3fr;
      gap: 24px;
    }
    @media (max-width: 900px) {
      .hero-inner { grid-template-columns: 1fr; }
    }
    .surface {
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border: 1px solid rgba(148,163,184,0.18);
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      overflow: hidden;
    }
    .photo-card {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      animation: fadeInUp 700ms ease both;
    }
    .accent-ring {
      position: absolute;
      inset: -2px;
      border-radius: 18px;
      pointer-events: none;
      background: radial-gradient(1200px 400px at -10% -10%, rgba(56, 189, 248, 0.15), transparent 40%),
                  radial-gradient(1200px 400px at 110% 110%, rgba(99, 102, 241, 0.15), transparent 40%);
    }
    .photo-frame {
      width: 100%;
      aspect-ratio: 4 / 5;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid rgba(148,163,184,0.25);
      background: rgba(2,6,23,0.6);
      display: grid;
      place-items: center;
    }
    .photo-frame img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transform: scale(1.02);
      transition: transform 300ms ease;
    }
    .photo-frame:hover img { transform: scale(1.06); }
    .intro-card {
      padding: 24px 28px;
      display: flex;
      flex-direction: column;
      gap: 14px;
      animation: fadeInUp 700ms ease 120ms both;
    }
    .greeting {
      margin: 0;
      font-size: 28px;
      line-height: 1.25;
      letter-spacing: 0.2px;
    }
    .lead {
      margin: 0;
      font-size: 16px;
      color: #cbd5e1;
    }
    .quote {
      margin: 6px 0 0;
      padding: 12px 14px;
      font-size: 16px;
      color: #e2e8f0;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(148,163,184,0.18);
      border-left: 4px solid #38bdf8;
      border-radius: 10px;
    }
    
    /* Projects Page Styles */
    .projects-container {
      max-width: 1100px;
      margin: 0 auto;
    }
    .page-title {
      font-size: 32px;
      font-weight: 700;
      margin: 0 0 8px 0;
      text-align: center;
      background: linear-gradient(135deg, #38bdf8, #6366f1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .page-subtitle {
      font-size: 16px;
      color: #94a3b8;
      text-align: center;
      margin: 0 0 40px 0;
    }
    .projects-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
      margin-top: 40px;
    }
    @media (max-width: 768px) {
      .projects-grid { grid-template-columns: 1fr; }
    }
    .project-card {
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border: 1px solid rgba(148,163,184,0.18);
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      animation: fadeInUp 700ms ease both;
    }
    .project-card:nth-child(2) { animation-delay: 150ms; }
    .project-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.45);
    }
    .project-header {
      padding: 24px 24px 16px;
      border-bottom: 1px solid rgba(148,163,184,0.15);
    }
    .project-title {
      font-size: 20px;
      font-weight: 600;
      margin: 0 0 8px 0;
      color: #f1f5f9;
    }
    .project-description {
      font-size: 14px;
      color: #94a3b8;
      margin: 0;
      line-height: 1.5;
    }
    .project-image-container {
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 300px;
      background: rgba(2,6,23,0.3);
    }
    .project-image {
      max-width: 100%;
      max-height: 400px;
      border-radius: 12px;
      border: 1px solid rgba(148,163,184,0.25);
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      transition: transform 0.3s ease;
    }
    .project-image:hover {
      transform: scale(1.02);
    }
    
    /* Record Player Styles */
    .record-player-container {
      max-width: 800px;
      width: 100%;
      margin: 0 auto;
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border: 1px solid rgba(148,163,184,0.18);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.4);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      padding: 40px;
      text-align: center;
    }
    .turntable {
      position: relative;
      width: 300px;
      height: 300px;
      margin: 0 auto 30px;
      background: radial-gradient(circle, #1e293b 0%, #0f172a 70%);
      border-radius: 50%;
      border: 8px solid #374151;
      box-shadow: inset 0 0 20px rgba(0,0,0,0.5), 0 10px 30px rgba(0,0,0,0.3);
    }
    .record {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 200px;
      height: 200px;
      background: radial-gradient(circle, #1f2937 0%, #111827 100%);
      border-radius: 50%;
      border: 2px solid #374151;
      transition: transform 0.1s linear;
      cursor: pointer;
    }
    .record.playing {
      animation: spin 3s linear infinite;
    }
    .record-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      background: #6b7280;
      border-radius: 50%;
      border: 2px solid #9ca3af;
    }
    .record-grooves {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 180px;
      height: 180px;
      border: 1px solid rgba(156, 163, 175, 0.3);
      border-radius: 50%;
    }
    .record-grooves::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 140px;
      height: 140px;
      border: 1px solid rgba(156, 163, 175, 0.2);
      border-radius: 50%;
    }
    .record-grooves::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100px;
      height: 100px;
      border: 1px solid rgba(156, 163, 175, 0.1);
      border-radius: 50%;
    }
    .tone-arm {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 4px;
      height: 120px;
      background: linear-gradient(to bottom, #6b7280, #374151);
      border-radius: 2px;
      transform-origin: top center;
      transition: transform 0.3s ease;
    }
    .tone-arm.playing {
      transform: rotate(15deg);
    }
    .tone-arm-head {
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 12px;
      height: 12px;
      background: #1f2937;
      border-radius: 50%;
      border: 2px solid #374151;
    }
    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-top: 30px;
    }
    .play-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(135deg, #38bdf8, #6366f1);
      color: white;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(56, 189, 248, 0.3);
    }
    .play-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(56, 189, 248, 0.4);
    }
    .play-btn:active {
      transform: scale(0.95);
    }
    .track-info {
      text-align: center;
      margin-top: 20px;
    }
    .track-title {
      font-size: 18px;
      font-weight: 600;
      color: #f1f5f9;
      margin: 0 0 5px 0;
    }
    .track-artist {
      font-size: 14px;
      color: #94a3b8;
      margin: 0;
    }
    .album-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
      margin-top: 40px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    .album-cover {
      width: 150px;
      height: 150px;
      border-radius: 8px;
      background: linear-gradient(135deg, #374151, #1f2937);
      border: 2px solid rgba(148,163,184,0.2);
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #94a3b8;
      font-size: 12px;
      text-align: center;
    }
    .album-cover:hover {
      transform: translateY(-4px);
      border-color: #38bdf8;
      box-shadow: 0 8px 25px rgba(56, 189, 248, 0.2);
    }
    .album-cover.active {
      border-color: #38bdf8;
      box-shadow: 0 0 20px rgba(56, 189, 248, 0.3);
    }
    .waveform {
      width: 100%;
      height: 60px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      margin: 20px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .waveform-bar {
      width: 4px;
      height: 20px;
      background: #38bdf8;
      margin: 0 2px;
      border-radius: 2px;
      animation: wave 1.5s ease-in-out infinite;
    }
    .waveform-bar:nth-child(2) { animation-delay: 0.1s; }
    .waveform-bar:nth-child(3) { animation-delay: 0.2s; }
    .waveform-bar:nth-child(4) { animation-delay: 0.3s; }
    .waveform-bar:nth-child(5) { animation-delay: 0.4s; }
    .waveform-bar:nth-child(6) { animation-delay: 0.5s; }
    .waveform-bar:nth-child(7) { animation-delay: 0.6s; }
    .waveform-bar:nth-child(8) { animation-delay: 0.7s; }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes spin {
      from { transform: translate(-50%, -50%) rotate(0deg); }
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }
    @keyframes wave {
      0%, 100% { height: 20px; }
      50% { height: 40px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div class="branding">
        <h1 class="site-title">Welcome to my website!</h1>
        <p class="site-tagline">This will act as my portfolio for EDU-241</p>
        <p class="site-tagline">This is currently in development and will be updated as we move forward.</p>
      </div>
      <nav aria-label="Primary">
        <a class="nav-link active" data-page="home">Home</a>
        <a class="nav-link" data-page="projects">Projects</a>
        <a class="nav-link" data-page="record-player">Drop a Record</a>
        <a class="nav-link" href="http://localhost:3000/poll-widget.html" target="_blank">Live Poll</a>
        <a class="nav-link" data-page="about">About</a>
        <a class="nav-link" data-page="contact">Contact</a>
      </nav>
    </div>
  </header>
  <main>
    <!-- Home Page -->
    <div id="home" class="page active">
      <section class="hero">
        <div class="hero-inner">
          <div class="surface photo-card">
            <div class="accent-ring"></div>
            <div class="photo-frame">
              <img src="assets/profile.png" alt="Your profile photo" />
            </div>
          </div>
          <div class="surface intro-card">
            <h2 class="greeting">Hi, I'm Tomas. Welcome.</h2>
            <p class="lead">Throughout this website are various links to projects and resources related to the EDU-241 course. To navigate through my website, refer to the headers at the top of the page.</p>
            <blockquote class="quote">"The real problem is not whether machines think but whether men do." - B. F. Skinner</blockquote>
            <blockquote class="quote">"The more we know about how to do something, the harder it is to learn how to do it differently." ― Everett M. Rogers</blockquote>
            <blockquote class="quote">"Science is what we understand well enough to explain to a computer. Art is everything else we do." ― Donald Knuth</blockquote>
          </div>
        </div>
      </section>
    </div>

    <!-- Projects Page -->
    <div id="projects" class="page">
      <div class="projects-container">
        <h1 class="page-title">EDU-241 Projects</h1>
        <p class="page-subtitle">Here is where all of my course projects will be located</p>
        
        <div class="projects-grid">
          <div class="project-card">
            <div class="project-header">
              <h2 class="project-title">Infographic</h2>
              <p class="project-description">This is my infographic on the Gestalt principles. The Gestalt principles are laws of human perception that describe how humans group similar elements, recognize patterns, and simplify complex images when perceiving objects. We use these to make higher quality and more intuitive products, like an infographic!</p>
            </div>
            <div class="project-image-container">
              <img src="assets/infographic.png" alt="Educational Infographic" class="project-image" />
            </div>
          </div>
          
          <div class="project-card">
            <div class="project-header">
              <h2 class="project-title">Meme</h2>
              <p class="project-description">Here is my homemade meme. Machine learning under the hood is just some cool math.</p>
            </div>
            <div class="project-image-container">
              <img src="assets/meme.png" alt="Educational Meme" class="project-image" />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Record Player Page -->
    <div id="record-player" class="page">
      <h1 class="page-title">Drop a Record</h1>
      <p class="page-subtitle">These are my favorite albums. Give one a spin as you explore my website!</p>
      
      <div class="record-player-container">
        <div class="turntable">
          <div class="tone-arm" id="toneArm">
            <div class="tone-arm-head"></div>
          </div>
          <div class="record" id="record">
            <div class="record-grooves"></div>
            <div class="record-center"></div>
          </div>
        </div>
        
        <div class="controls">
          <button class="play-btn" id="playBtn">▶</button>
        </div>
        
        <div class="track-info">
          <h3 class="track-title" id="trackTitle">Select an album to play</h3>
          <p class="track-artist" id="trackArtist">Choose from the collection below</p>
        </div>
        
        <div class="waveform" id="waveform">
          <div class="waveform-bar"></div>
          <div class="waveform-bar"></div>
          <div class="waveform-bar"></div>
          <div class="waveform-bar"></div>
          <div class="waveform-bar"></div>
          <div class="waveform-bar"></div>
          <div class="waveform-bar"></div>
          <div class="waveform-bar"></div>
        </div>
        
        <div class="album-grid">
          <div class="album-cover" data-track="aja">
            <img src="assets/albums/Aja.png" alt="Aja Album Cover" style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px;">
          </div>
          <div class="album-cover" data-track="doo_wops">
            <img src="assets/albums/Doo_Wops_And_Hooligans.jpg" alt="Doo-Wops & Hooligans Album Cover" style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px;">
          </div>
          <div class="album-cover" data-track="silk_degrees">
            <img src="assets/albums/Silk_Degrees.png" alt="Silk Degrees Album Cover" style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px;">
          </div>
          <div class="album-cover" data-track="american_idiot">
            <img src="assets/albums/American_Idiot.jpg" alt="American Idiot Album Cover" style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px;">
          </div>
        </div>
      </div>
    </div>

    <!-- About Page -->
    <div id="about" class="page">
      <div class="projects-container">
        <h1 class="page-title">About</h1>
        <p class="page-subtitle">Coming soon...</p>
      </div>
    </div>

    <!-- Contact Page -->
    <div id="contact" class="page">
      <div class="projects-container">
        <h1 class="page-title">Contact</h1>
        <p class="page-subtitle">Coming soon...</p>
      </div>
    </div>
  </main>

  <script>
    // Global Audio Manager - persists across page navigation
    class AudioManager {
      constructor() {
        this.isPlaying = false;
        this.currentAlbum = null;
        this.currentTrackIndex = 0;
        this.audioContext = null;
        this.audioSource = null;
        this.html5Audio = null;
        this.analyser = null;
        this.dataArray = null;
        this.animationId = null;
        this.trackList = [];
        this.isInitialized = false;
      }
      
      init() {
        if (this.isInitialized) return;
        
        this.playBtn = document.getElementById('playBtn');
        this.record = document.getElementById('record');
        this.toneArm = document.getElementById('toneArm');
        this.trackTitle = document.getElementById('trackTitle');
        this.trackArtist = document.getElementById('trackArtist');
        this.waveform = document.getElementById('waveform');
        
        if (this.playBtn) {
          this.playBtn.addEventListener('click', () => this.togglePlay());
        }
        
        // Album selection
        document.querySelectorAll('.album-cover').forEach(cover => {
          cover.addEventListener('click', (e) => {
            const albumId = e.currentTarget.dataset.track;
            this.selectAlbum(albumId);
          });
        });
        
        // Initialize audio context on first user interaction
        document.addEventListener('click', () => {
          if (!this.audioContext) {
            this.initAudioContext();
          }
        }, { once: true });
        
        // Test audio file accessibility
        this.testAudioFiles();
        this.isInitialized = true;
      }
      
      initAudioContext() {
        try {
          this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
          this.analyser = this.audioContext.createAnalyser();
          this.analyser.fftSize = 256;
          this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);
          console.log('Audio context initialized');
        } catch (error) {
          console.error('Web Audio API not supported:', error);
        }
      }
      
      async testAudioFiles() {
        console.log('Testing audio file accessibility...');
        try {
          const testPath = 'assets/audio/Aja/Aja.mp3';
          const response = await fetch(testPath);
          console.log(`Test file response: ${response.status} ${response.statusText}`);
          if (response.ok) {
            console.log('Audio files are accessible');
          } else {
            console.error('Audio files not accessible:', response.status);
          }
        } catch (error) {
          console.error('Error testing audio files:', error);
        }
      }
      
      selectAlbum(albumId) {
        // Remove active class from all albums
        document.querySelectorAll('.album-cover').forEach(cover => {
          cover.classList.remove('active');
        });
        
        // Add active class to selected album
        document.querySelector(`[data-track="${albumId}"]`).classList.add('active');
        
        // Define album data
        const albumData = {
          aja: {
            name: "Aja",
            artist: "Steely Dan",
            tracks: [
              { name: "Aja", file: "Aja.mp3" },
              { name: "Black Cow", file: "Black Cow.mp3" },
              { name: "Deacon Blues", file: "Deacon Blues.mp3" },
              { name: "Peg", file: "Peg.mp3" },
              { name: "Home at Last", file: "Home at Last (Aja September 23 1977).mp3" },
              { name: "I Got the News", file: "i got the news.mp3" },
              { name: "Josie", file: "Josie.mp3" }
            ]
          },
          doo_wops: {
            name: "Doo-Wops & Hooligans",
            artist: "Bruno Mars",
            tracks: [
              { name: "Doo-Wops & Hooligans", file: "Doo-Wops_and_Hooligans.mp4" }
            ]
          },
          silk_degrees: {
            name: "Silk Degrees",
            artist: "Boz Scaggs",
            tracks: [
              { name: "What Can I Say", file: "01. What Can I Say.mp3" },
              { name: "Georgia", file: "02. Georgia.mp3" },
              { name: "Jump Street", file: "03. Jump Street.mp3" },
              { name: "What Do You Want The Girl To Do", file: "04. What Do You Want The Girl To Do.mp3" },
              { name: "Harbor Lights", file: "05. Harbor Lights.mp3" },
              { name: "Lowdown", file: "06. Lowdown.mp3" },
              { name: "It's Over", file: "07. It's Over.mp3" },
              { name: "Love Me Tomorrow", file: "08. Love Me Tomorrow.mp3" },
              { name: "Lido Shuffle", file: "09. Lido Shuffle.mp3" },
              { name: "We're All Alone", file: "10. We're All Alone.mp3" }
            ]
          },
          american_idiot: { 
            name: "American Idiot",
            artist: "Green Day",
            tracks: [
              { name: "American Idiot", file: "01-American Idiot.mp3" },
              { name: "Jesus of Suburbia", file: "02-Jesus of Suburbia.mp3" },
              { name: "Holiday", file: "03-Holiday.mp3" },
              { name: "Boulevard of Broken Dreams", file: "04-Boulevard of Broken Dreams.mp3" },
              { name: "Are We the Enemy?", file: "05-Are We the Enemy.mp3" },
              { name: "St. Jimmy", file: "06-St. Jimmy.mp3" },
              { name: "Give Me Novacaine", file: "07-Give Me Novacaine.mp3" },
              { name: "She's a Rebel", file: "08-She's a Rebel.mp3" },
              { name: "Extraordinary Girl", file: "09-Extraordinary Girl.mp3" },
              { name: "Letterbomb", file: "10-Letterbomb.mp3" },
              { name: "Wake Me Up When September Ends", file: "11-Wake Me Up When September Ends.mp3" },
              { name: "Homecoming", file: "12-Homecoming.mp3" },
              { name: "Whatsername", file: "13-Whatsername.mp3" }
            ]
          }
        };
        
        const album = albumData[albumId];
        this.currentAlbum = album;
        this.trackList = album.tracks || [];
        this.currentTrackIndex = 0;
        
        // Update display
        if (this.trackList.length > 0) {
          this.trackTitle.textContent = this.trackList[0].name;
          this.trackArtist.textContent = `${album.artist} - ${album.name}`;
        } else {
          this.trackTitle.textContent = album.name;
          this.trackArtist.textContent = album.artist;
        }
        
        // Stop current playback if playing
        if (this.isPlaying) {
          this.stop();
        }
      }
      
      togglePlay() {
        if (this.isPlaying) {
          this.stop();
        } else {
          this.play();
        }
      }
      
      async play() {
        if (!this.currentAlbum || this.trackList.length === 0) {
          alert('Please select an album first!');
          return;
        }
        
        // Ensure audio context is initialized and resumed
        if (!this.audioContext) {
          this.initAudioContext();
        }
        
        if (this.audioContext.state === 'suspended') {
          await this.audioContext.resume();
          console.log('Audio context resumed');
        }
        
        this.isPlaying = true;
        this.playBtn.textContent = '⏸';
        this.record.classList.add('playing');
        this.toneArm.classList.add('playing');
        this.waveform.style.display = 'flex';
        
        // Start waveform animation
        this.animateWaveform();
        
        // Play current track
        await this.playCurrentTrack();
      }
      
      async playCurrentTrack() {
        if (this.currentTrackIndex >= this.trackList.length) {
          // Album finished, stop playback
          this.stop();
          return;
        }
        
        const track = this.trackList[this.currentTrackIndex];
        this.trackTitle.textContent = track.name;
        console.log(`Attempting to play: ${track.name}`);
        
        try {
          // Try Web Audio API first
          await this.playWithWebAudio(track);
        } catch (error) {
          console.error('Web Audio API failed, trying HTML5 audio:', error);
          try {
            await this.playWithHTML5Audio(track);
          } catch (html5Error) {
            console.error('HTML5 audio also failed:', html5Error);
            alert(`Error playing ${track.name}: ${error.message}\n\nTry accessing via: http://localhost:8000/app.html`);
            
            // Fallback: simulate track duration
            setTimeout(() => {
              this.currentTrackIndex++;
              if (this.isPlaying) {
                this.playCurrentTrack();
              }
            }, 5000);
          }
        }
      }
      
      async playWithWebAudio(track) {
        const albumFolder = this.getAlbumFolder(this.currentAlbum.name);
        const audioPath = `assets/audio/${albumFolder}/${track.file}`;
        console.log(`Loading audio from: ${audioPath}`);
        
        const response = await fetch(audioPath);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const arrayBuffer = await response.arrayBuffer();
        console.log(`Audio loaded, size: ${arrayBuffer.byteLength} bytes`);
        
        const audioBuffer = await this.audioContext.decodeAudioData(arrayBuffer);
        console.log(`Audio decoded, duration: ${audioBuffer.duration} seconds`);
        
        // Stop any existing audio
        if (this.audioSource) {
          try {
            this.audioSource.stop();
          } catch (e) {
            // Source might already be stopped
          }
        }
        
        // Create new audio source
        this.audioSource = this.audioContext.createBufferSource();
        this.audioSource.buffer = audioBuffer;
        this.audioSource.connect(this.analyser);
        this.analyser.connect(this.audioContext.destination);
        
        // Set up end event to play next track
        this.audioSource.onended = () => {
          console.log(`Track ended: ${track.name}`);
          this.currentTrackIndex++;
          if (this.isPlaying) {
            this.playCurrentTrack();
          }
        };
        
        // Start playback
        this.audioSource.start();
        console.log(`Successfully started playing with Web Audio: ${track.name}`);
      }
      
      async playWithHTML5Audio(track) {
        // Stop any existing HTML5 audio
        if (this.html5Audio) {
          this.html5Audio.pause();
          this.html5Audio = null;
        }
        
        const albumFolder = this.getAlbumFolder(this.currentAlbum.name);
        const audioPath = `assets/audio/${albumFolder}/${track.file}`;
        console.log(`Loading HTML5 audio from: ${audioPath}`);
        
        this.html5Audio = new Audio(audioPath);
        
        // Set up end event to play next track
        this.html5Audio.onended = () => {
          console.log(`HTML5 track ended: ${track.name}`);
          this.currentTrackIndex++;
          if (this.isPlaying) {
            this.playCurrentTrack();
          }
        };
        
        this.html5Audio.onerror = (error) => {
          console.error('HTML5 audio error:', error);
          throw new Error('HTML5 audio failed to load');
        };
        
        // Start playback
        await this.html5Audio.play();
        console.log(`Successfully started playing with HTML5: ${track.name}`);
      }
      
      stop() {
        this.isPlaying = false;
        this.playBtn.textContent = '▶';
        this.record.classList.remove('playing');
        this.toneArm.classList.remove('playing');
        this.waveform.style.display = 'none';
        
        if (this.animationId) {
          cancelAnimationFrame(this.animationId);
        }
        
        // Stop Web Audio API playback
        if (this.audioSource) {
          try {
            this.audioSource.stop();
          } catch (error) {
            // Audio source might already be stopped
          }
          this.audioSource = null;
        }
        
        // Stop HTML5 audio playback
        if (this.html5Audio) {
          this.html5Audio.pause();
          this.html5Audio = null;
        }
        
        console.log('Stopped playback');
      }
      
      getAlbumFolder(albumName) {
        const folderMap = {
          "Aja": "Aja",
          "Doo-Wops & Hooligans": "Doo_Wops_And_Hooligans",
          "Silk Degrees": "Silk_Degrees",
          "American Idiot": "American_Idiot"

        };
        return folderMap[albumName] || "Aja";
      }
      
      animateWaveform() {
        if (!this.isPlaying) return;
        
        // Simple waveform animation
        const bars = this.waveform.querySelectorAll('.waveform-bar');
        bars.forEach((bar, index) => {
          const height = Math.random() * 40 + 10;
          bar.style.height = `${height}px`;
        });
        
        this.animationId = requestAnimationFrame(() => this.animateWaveform());
      }
    }

    // Global audio manager instance
    const audioManager = new AudioManager();

    // Page Navigation System
    class PageManager {
      constructor() {
        this.currentPage = 'home';
        this.init();
      }
      
      init() {
        // Add click handlers to navigation links
        document.querySelectorAll('.nav-link').forEach(link => {
          link.addEventListener('click', (e) => {
            e.preventDefault();
            const page = e.target.dataset.page;
            this.showPage(page);
          });
        });
        
        // Initialize audio manager when record player page is shown
        this.showPage('home');
      }
      
      showPage(pageName) {
        // Hide all pages
        document.querySelectorAll('.page').forEach(page => {
          page.classList.remove('active');
        });
        
        // Show selected page
        const targetPage = document.getElementById(pageName);
        if (targetPage) {
          targetPage.classList.add('active');
        }
        
        // Update navigation active state
        document.querySelectorAll('.nav-link').forEach(link => {
          link.classList.remove('active');
        });
        document.querySelector(`[data-page="${pageName}"]`).classList.add('active');
        
        // Initialize audio manager if on record player page
        if (pageName === 'record-player') {
          audioManager.init();
        }
        
        this.currentPage = pageName;
        console.log(`Switched to page: ${pageName}`);
      }
    }

    // Initialize the application
    document.addEventListener('DOMContentLoaded', () => {
      new PageManager();
    });
  </script>
</body>
</html>
